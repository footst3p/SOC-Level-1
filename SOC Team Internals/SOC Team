# SOC L1 Alert Triage
### From Events to Alerts
First, an event must occur, like user login, process launch, or file download. Then, the system, like your OS, a firewall, or a cloud provider must log the event.<br>
After that, all system logs must be shipped to a security solution like SIEM or EDR. The SOC team can receive millions of logs per day from thousands of different systems, 
where most of the events are expected, but some require attention. Alert, a notification generated by a security solution when a specific event or sequence of events occurs,
is what saves SOC analysts from manual log review by highlighting only suspicious, anomalous events. With alerts, analysts triage just dozens of alerts per day instead of millions of raw logs.

### Alert Management Platforms:
1. SIEM System: SIEM have solid alert management capabilities and are a perfect choice for most SOC teams.
2. EDR or NDR: While EDR and NDR provide their own alert dashboards, it is preferred to use SIEM or SOAR.
3. SOAR System: Bigger SOC teams can use SOAR to aggregate and centralise alerts from multiple solutions.
4. ITSM System: Some teams may have a custom ticket management (ITSM) setup using a dedicated solution
(The GIF above is taken from Trello, a simple tool that can be adapted to ITSM needs)

### L1 Role in Alert Triage
SOC L1 analysts are the first line of defence, and they are the ones who work with alerts the most. Depending on various factors, L1 analysts may receive zero to a hundred alerts a day, every 
one of which can reveal a cyberattack. Still, everyone in the SOC team is somehow involved in the alert triage:

- SOC L1 analysts:  Review the alerts, distinguish bad from good, and notify L2 analysts in case of a real threat
- SOC L2 analysts:  Receive the alerts escalated by L1 analysts and perform deeper analysis and remediation
- SOC engineers:  Ensure the alerts contain enough information required for efficient alert triage
- SOC manager:  Track speed and quality of alert triage to ensure that real attacks won't be missed

### Alert Properties:
1. Alert Time: Shows alert creation time.
2. Alert Name: Provides a summary of what happened
3. Alert Severity: Defines the urgency of the alert
4. Alert Status: Informs if somebody is working on the alert.
5. Alert Verdict: Also called alert classification, explains if the alert is a real threat or noise

### Alert Prioritisation
The process of deciding which to take is called Alert Prioritisation.

### Picking the Right Alert
Every SOC team decides on its own prioritisation rules and usually automates them by setting the appropriate alert sorting logic in SIEM or EDR. Below, you may see the generic, simplest, and most commonly used approach:

1. Filter the alerts: Make sure you don't take the alert that other analysts have already reviewed, or that is already being investigated by one of your teammates. You should only take new, yet unseen and unresolved alerts.
2. Sort by severity: Start with critical alerts, then high, medium, and finally low. This is because detection engineers design rules so that critical alerts are much more likely to be real, major threats and cause much more 
impact than medium or low ones.
3. Sort by time: Start with the oldest alerts and end with the newest ones. The idea is that if both alerts are about two breaches, the hacker from the older breach is likely already dumping your data, while the "newcomer"
has just started the discovery.

### Alert Triage
Finally, you are ready to review the chosen alert! The process is quite operationally heavy, but you will soon see why every step is important. Also, note that the alert review by SOC analysts can also be called alert triage, 
alert handling, alert processing, alert investigation, or alert analysis. During this module, we will stick to the Alert Triage option

1. Initial Actions

The initial steps are designed to ensure that you take ownership of the assigned alert and avoid interfering with alerts being handled by other analysts, and confirm that you are fully prepared to proceed with the detailed 
investigation. You achieve it by first assigning the alert to yourself, moving it to In Progress, and then familiarising yourself with the alert details like its name, description, and key indicators.

2. Investigation

This is the most complex step, requiring you to apply your technical knowledge and experience to understand the activity and properly analyse its legitimacy in SIEM or EDR logs. To support L1 analysts with this step, some teams 
develop Workbooks (also known as playbooks or runbooks) - instructions on how to investigate the specific category of alerts. If workbooks are not available, below are some key recommendations:

    Understand who is under threat, like the affected user, hostname, cloud, network, or website
    Note the action described in the alert, like whether it was a suspicious login, malware, or phishing
    Review surrounding events, looking for suspicious actions shortly after or before the alert
    Use threat intelligence platforms or other available resources to verify your thoughts

3. Final Actions

Your decisions here determine whether you found or missed the potential cyberattack. Some actions like Escalation or Commenting will be explained in the following rooms, so don't worry if they sound complex right now. First, 
decide if the alert you investigated is malicious (True Positive) or not (False Positive). Then, prepare your detailed comment explaining your analysis steps and verdict reasoning, return to the dashboard and move it to the Closed status.

SOC Dashboard Notes

If you didn't receive a flag after your triage, it means that the values you set are wrong.
You can reset the SOC dashboard by clicking Restart on the top right in the TryHackMe SIEM.

# SOC L1 Alert Reporting
During or after alert triage, L1 analysts may be uncertain about how to classify the alert, requiring senior support or information from the system owner. Also, L1 may deal with real cyberattacks and breaches that need immediate 
attention and remediation actions.

### Alert Funnel
First, L1 analysts receive the alerts in a SIEM, EDR, or a ticket management platform. Most of the alerts are closed as False Positives or are handled on L1 level, but complex and threatening ones are sent to L2 that remediate 
most breaches. And to send the alerts further, you need to learn three new terms: reporting, escalation, and communication.
1. Alert Reporting: Before closing or passing the alert to L2, you might have to report it. Depending on team standards and alert severity, instead of a short alert comment, you can be required to document your investigation in 
detail, ensuring all relevant evidence is included. This is especially important for True Positives, which require escalation.
2. Alert Escalation: If the True Positive alert requires additional actions or deeper investigation, escalate it to the L2 analyst for further review following the agreed procedures. 
That's where your alert report comes in handy since L2 will use it to get the initial context and spend less on the analysis from scratch.
3. Communication: You may also need to communicate with other departments during or after the analysis. For example, ask the IT team if they confirm granting administrative privileges to some users or contact HR to get more 
information about the newly hired employee.

### Reporting Guide
Before we move on, it is essential to clarify why anyone would want L1 analysts to write reports in addition to marking them as True or False Positives and why this topic can not be underestimated. Having L1 analysts write 
alert reports serves several key purposes:
1. Provide context for escalation:
- A well-written report saves lots of time for L2 analysts
- Also, it helps them quickly understand what happened

2. Save findings for the records:

- Raw SIEM logs are stored for 3-12 months, but alerts are kept indefinitely
- As a result, it's better to keep all the context inside the alert, just in case

3. Improve investigation skills:

- If you can't explain it simply, you don't understand it well enough
- Report writing is a great way to boost L1 skills by summarising alerts

### Report Format
Imagine yourself as an L2 analyst, a DFIR team member, or an IT professional who needs to understand the alert. What would you want to see in the report?
We recommend you follow the Five Ws approach and include at least these items in the report:

- Who: Which user logs in, runs the command, or downloads the file
- What: What exact action or event sequence was performed
- When: When exactly did the suspicious activity start and ended
- Where: Which device, IP, or website was involved in the alert
- Why: The most important W, the reasoning for your final verdict

### Escalation Guide
After you have made a verdict and written your alert report, you must choose whether to escalate the alert to L2. Again, the answer may differ from team to team, but the following recommendations would generally fit most SOC teams. You should escalate the alerts if:

1. The alert is an indicator of a major cyberattack requiring deeper investigation or DFIR
2. Remediation actions like malware removal, host isolation, or password reset are required
3. Communication with customers, partners, management, or law enforcement agencies is required
4. You just do not fully understand the alert and need some help from more senior analysts
### Escalation Steps
To escalate the alert, in most cases, all you have to do is to reassign the alert to the L2 on shift and ping them in corporate chat or in person. In some teams though, you may be required 
to create a formal written escalation request with dozens of required fields.
No matter what the agreements are, L2 will eventually receive the ticket from you, read your report, and contact you in case of any questions. Once everything is clear, the L2 analyst will 
typically research the alert details further, validate if the alert is indeed a True Positive, communicate with other departments if needed, and, for major incidents, start a formal Incident Response process.
### Requesting L2 Support
It is generally fine for L1 to request senior support if something is unclear. Especially in your first months, it's always better to discuss the alert and clarify SOC procedures than to blindly close the alert
you don't understand yourself. The procedures for requesting support may differ, but the flow generally looks like this:

### SOC Dashboard Escalation

1. Move the alert to In Progress status and do the analysis
2. Write an alert report and set your verdict, such as True Positive
3. If escalation is required, assign the alert to your L2 on shift
4. L2 will receive a notification and start from your alert report

### SOC Communication
The escalation and reporting topics should sound straightforward and logical to you. But, as always, it's easier said than done, and you should be prepared for unexpected scenarios and know what to do in critical cases. 
In the best scenario, the SOC team has its own Crisis Communication procedures - the guides and processes to help you and your teammates resolve the issues. If not, you are advised to read the cases below and be prepared to handle them effectively.<br>

Communication Cases:

- You need to escalate an urgent, critical alert, but L2 is unavailable and does not respond for 30 minutes.
  Ensure you know where to find emergency contacts. First, try to call L2, then L3, and finally your manager.

- The alert about Slack/Teams account compromise requires you to validate the login with the affected user.
  Do not contact the user through the breached chat - use alternative contact methods like a phone call.

- You receive an overwhelming number of alerts during a short period of time, some of which are critical.
  Prioritise the alerts according to the workflow, but inform your L2 on shift about the situation.

- After a few days, you realise that you misclassified the alert and likely missed a malicious action.
  Immediately reach out to your L2 explaining your concerns. Threat actors can be silent for weeks before impact.

- You can not complete the alert triage since the SIEM logs are not parsed correctly or are not searchable.
  Do not skip the alert - investigate what you can and report the issue to your L2 on shift or SOC engineer.

# SOC Workbooks and Lookups:
1. Identity Inventory:
Identity inventory is a catalogue of corporate employees (user accounts), services (machine accounts), and their details like privileges, contacts, and roles within the company. 
For the scenario above, identity inventory would help you get context about G.Baker and R.Lund, and make it simpler to decide if the activity was expected or not.

-->> Sources of Identities:
- Active Directory: AD itself is an identity database
- SSO Providers
- HR Systems
- Customer Solution

2. Asset Inventory
Asset inventory, also called asset lookup, is a list of all computing resources within an organisation's IT environment. Note that while "asset" is a vague term and can also refer to software, 
ardware, or employees, this room emphasises servers and workstations only. For the scenario above, asset inventory would help you get context about the HQ-FINFS-02 server.

### Workbook
SOC Workbooks

SOC workbook, also called playbook, runbook, or workflow, is a structured document that defines the steps required to investigate and remediate specific threats efficiently and consistently. 
Since L1 analysts are considered junior specialists and are not expected to triage every possible attack scenario perfectly, senior analysts often prepare workbooks to support their less 
experienced teammates. L1 analysts are recommended and sometimes even required to triage the alerts precisely according to workbooks to avoid mistakes and streamline the analysis.

### Core Metrics
To begin with, let's recall the main goal of a SOC - to protect the confidentiality, integrity, and availability of the organisation's digital assets. The SOC team performs its purpose 
by developing, receiving, and triaging alerts. The L1 analysts' role in this process is to reliably report True Positives to the higher level, to L2. This leads us to the first four metrics:
1. Alerts Count: Overall load of SOC analysts
2. False Positive Rate: Level of noise in the alerts
3. Alert Escalation Rate: Experience of L1 analysts
4. Threat Detection Rate: Reliability of the SOC team
